{"version":3,"file":"utils.cjs.production.min.js","sources":["../src/constants.ts","../src/sortingFns/sortingFns.ts","../src/langUtils/langUtils.ts"],"sourcesContent":["import { TDialect, TLang, TRegion } from './types';\r\n\r\nexport const DESCRIPTIONS_JOINER = '/';\r\nexport const NOT_DEFINED_PLACEHOLDER = '- not defined -';\r\nexport const LOADING_TAG_PLACEHOLDER = {\r\n  tag: 'loading',\r\n  descriptions: ['Loading data...'],\r\n} as TDialect & TRegion & TLang;\r\n\r\nexport enum GroupedFilterSymbols {\r\n  Digits = '0-9',\r\n  SpecialCharacters = '#',\r\n}\r\n","import { NOT_DEFINED_PLACEHOLDER } from '../constants';\r\nimport { IDefinition, ITagInfo } from '../types';\r\n\r\nexport const sortSiteTextFn = (d1: IDefinition, d2: IDefinition) => {\r\n  if (\r\n    d1.siteTextlikeString &&\r\n    d2.siteTextlikeString &&\r\n    d1.siteTextlikeString.toLowerCase() > d2.siteTextlikeString.toLowerCase()\r\n  ) {\r\n    return 1;\r\n  }\r\n\r\n  if (\r\n    d1.siteTextlikeString &&\r\n    d2.siteTextlikeString &&\r\n    d1.siteTextlikeString.toLowerCase() < d2.siteTextlikeString.toLowerCase()\r\n  ) {\r\n    return -1;\r\n  }\r\n  return 0;\r\n};\r\n\r\nexport const sortTagInfosFn = (t1: ITagInfo, t2: ITagInfo) => {\r\n  if (t1.descriptions && t1.descriptions[0] === NOT_DEFINED_PLACEHOLDER) {\r\n    return -1;\r\n  }\r\n  if (t2.descriptions && t2.descriptions[0] === NOT_DEFINED_PLACEHOLDER) {\r\n    return 1;\r\n  }\r\n  if (\r\n    t1.descriptions &&\r\n    t2.descriptions &&\r\n    t1.descriptions[0] > t2.descriptions[0]\r\n  ) {\r\n    return 1;\r\n  }\r\n  if (\r\n    t1.descriptions &&\r\n    t2.descriptions &&\r\n    t1.descriptions[0] < t2.descriptions[0]\r\n  ) {\r\n    return -1;\r\n  }\r\n  return 0;\r\n};\r\n","import Tags from 'language-tags';\r\nimport { DESCRIPTIONS_JOINER, NOT_DEFINED_PLACEHOLDER } from '../constants';\r\nimport { sortTagInfosFn } from '../sortingFns/sortingFns';\r\nimport {\r\n  LanguageInfo,\r\n  LanguageInput,\r\n  TDialect,\r\n  TLang,\r\n  TRegion,\r\n} from '../types';\r\n\r\n\r\n\r\n// X_LANG_TAGS is an array of private (x-...) subtags; they are used as additional language tags to represent languages\r\n// that are not present in the `language-tags` npm package (which refers to the IANA registry).\r\n// List of main language tags we get from the `language-tags` library will be extended with these x- tags.\r\nexport const X_LANG_TAGS: Array<TLang> = [\r\n  { tag: 'x-senga', descriptions: ['Senga'] },\r\n  { tag: 'x-fungwe', descriptions: ['Fungwe'] },\r\n  { tag: 'x-tambo', descriptions: ['Tambo'] },\r\n  { tag: 'x-wandya', descriptions: ['Wandya'] },\r\n  { tag: 'x-lungu', descriptions: ['Lungu'] },\r\n  { tag: 'x-chikunda', descriptions: ['Chikunda'] },\r\n  { tag: 'x-kabdende', descriptions: ['Kabdende'] },\r\n  { tag: 'x-shila', descriptions: ['Shila'] },\r\n  { tag: 'x-mwenyi', descriptions: ['Mwenyi'] },\r\n  { tag: 'x-liuwa', descriptions: ['Liuwa'] },\r\n  { tag: 'x-Seabo', descriptions: ['Seabo'] },\r\n];\r\n\r\nenum TagTypes {\r\n  LANGUAGE = 'language',\r\n  REGION = 'region',\r\n  DIALECT = 'variant',\r\n}\r\n\r\nexport const xTag2langInfo = (tagGiven: string): LanguageInfo | undefined => {\r\n  const foundXtagIndex = X_LANG_TAGS.findIndex((xTag) => xTag.tag === tagGiven);\r\n  if (foundXtagIndex >= 0) {\r\n    return {\r\n      lang: X_LANG_TAGS[foundXtagIndex],\r\n    };\r\n  } else return undefined;\r\n};\r\n\r\nexport const tag2langInfo = (tagGiven: string): LanguageInfo => {\r\n  if (xTag2langInfo(tagGiven)) return xTag2langInfo(tagGiven)!;\r\n  const complexTag = Tags(tagGiven);\r\n  const lang = complexTag.find(TagTypes.LANGUAGE);\r\n  const region = complexTag.find(TagTypes.REGION);\r\n  const dialect = complexTag.find(TagTypes.DIALECT);\r\n  const langInfo: LanguageInfo = {\r\n    lang: { tag: lang?.format() || '', descriptions: lang?.descriptions() },\r\n  };\r\n  if (region) {\r\n    langInfo.region = {\r\n      tag: region.format(),\r\n      descriptions: region.descriptions(),\r\n    };\r\n  }\r\n  if (dialect) {\r\n    langInfo.dialect = {\r\n      tag: dialect.format(),\r\n      descriptions: dialect.descriptions(),\r\n    };\r\n  }\r\n  return langInfo;\r\n};\r\n\r\nexport const langInfo2tag = (\r\n  langInfo: LanguageInfo | undefined\r\n): string | undefined => {\r\n  if (!langInfo) return undefined;\r\n  const { lang, region, dialect } = langInfo;\r\n  let langTag = lang.tag;\r\n\r\n  const xTag = X_LANG_TAGS.find((xt) => xt.tag === langTag);\r\n  if (xTag) return xTag.tag;\r\n\r\n  region?.tag && (langTag += '-' + region?.tag);\r\n  dialect?.tag && (langTag += '-' + dialect?.tag);\r\n  return Tags(langTag).format();\r\n};\r\n\r\nexport const langInfo2langInput = (langInfo: LanguageInfo): LanguageInput => {\r\n  return {\r\n    language_code: langInfo.lang.tag,\r\n    dialect_code: langInfo.dialect?.tag || null,\r\n    geo_code: langInfo.region?.tag || null,\r\n  };\r\n};\r\n\r\nexport const langInfo2String = (langInfo: LanguageInfo | undefined): string => {\r\n  const xTag = X_LANG_TAGS.find((xt) => xt.tag === langInfo?.lang.tag);\r\n  if (xTag) {\r\n    return xTag.descriptions?.join(DESCRIPTIONS_JOINER) || xTag.tag;\r\n  }\r\n  let res = langInfo?.lang.descriptions?.join(DESCRIPTIONS_JOINER);\r\n  if (!res) return '';\r\n  if (langInfo?.region?.descriptions) {\r\n    res += ' ' + langInfo.region?.descriptions.join(DESCRIPTIONS_JOINER);\r\n  }\r\n  if (langInfo?.dialect?.descriptions) {\r\n    res +=\r\n      ', dialect:' + langInfo?.dialect?.descriptions.join(DESCRIPTIONS_JOINER);\r\n  }\r\n  return res;\r\n};\r\n\r\nexport const subTags2LangInfo = ({\r\n  lang,\r\n  region,\r\n  dialect,\r\n}: {\r\n  lang: string;\r\n  region?: string;\r\n  dialect?: string;\r\n}): LanguageInfo => {\r\n  if (xTag2langInfo(lang)) return xTag2langInfo(lang)!;\r\n  let langTag = lang;\r\n  region && (langTag += '-' + region);\r\n  dialect && (langTag += '-' + dialect);\r\n  langTag = Tags(langTag).format();\r\n  return tag2langInfo(langTag);\r\n};\r\n\r\nexport const compareLangInfo = (\r\n  a: LanguageInfo | null | undefined,\r\n  b: LanguageInfo | null | undefined\r\n): boolean => {\r\n  if (a === b) return true; // case both null or both undefined\r\n  if (!a || !b) return false; // case one of them null or undefined\r\n  if (a.lang.tag !== b.lang.tag) {\r\n    return false;\r\n  }\r\n\r\n  if (a.dialect?.tag !== b.dialect?.tag) {\r\n    return false;\r\n  }\r\n\r\n  if (a.region?.tag !== b.region?.tag) {\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\ntype LangsRegistry = {\r\n  langs: Array<TLang>;\r\n  dialects: Array<TDialect>;\r\n  regions: Array<TRegion>;\r\n};\r\n\r\nenum TagSpecialDescriptions {\r\n  PRIVATE_USE = 'Private use',\r\n}\r\n\r\n// make it async to test and prepare for possible language library change to async\r\nexport const getLangsRegistry = async (\r\n  enabledTags?: string[]\r\n): Promise<LangsRegistry> => {\r\n  return new Promise((resolve) => {\r\n    const allTags = Tags.search(/.*/);\r\n    const langs: Array<TLang> = [...X_LANG_TAGS];\r\n    const dialects: Array<TDialect> = [\r\n      { tag: null, descriptions: [NOT_DEFINED_PLACEHOLDER] },\r\n    ];\r\n    const regions: Array<TRegion> = [\r\n      { tag: null, descriptions: [NOT_DEFINED_PLACEHOLDER] },\r\n    ];\r\n\r\n    for (const currTag of allTags) {\r\n      if (enabledTags && !enabledTags.includes(currTag.format())) {\r\n        continue;\r\n      }\r\n\r\n      if (\r\n        currTag.deprecated() ||\r\n        currTag.descriptions().includes(TagSpecialDescriptions.PRIVATE_USE)\r\n      ) {\r\n        continue;\r\n      }\r\n\r\n      if (currTag.type() === TagTypes.LANGUAGE) {\r\n        langs.push({\r\n          tag: currTag.format(),\r\n          descriptions: currTag.descriptions(),\r\n        });\r\n      }\r\n      if (currTag.type() === TagTypes.REGION) {\r\n        regions.push({\r\n          tag: currTag.format(),\r\n          descriptions: currTag.descriptions(),\r\n        });\r\n      }\r\n      if (currTag.type() === TagTypes.DIALECT) {\r\n        dialects.push({\r\n          tag: currTag.format(),\r\n          descriptions: currTag.descriptions(),\r\n        });\r\n      }\r\n    }\r\n    langs.sort(sortTagInfosFn);\r\n    dialects.sort(sortTagInfosFn);\r\n    regions.sort(sortTagInfosFn);\r\n\r\n    resolve({\r\n      langs,\r\n      dialects,\r\n      regions,\r\n    });\r\n  });\r\n};\r\n\r\nexport const subTags2Tag = ({\r\n  lang,\r\n  region,\r\n  dialect,\r\n}: {\r\n  lang: string;\r\n  region?: string;\r\n  dialect?: string;\r\n}): string => {\r\n  if (X_LANG_TAGS.find((xt) => xt.tag === lang)) return lang;\r\n  let langTag = lang;\r\n  region && (langTag += '-' + region);\r\n  dialect && (langTag += '-' + dialect);\r\n  return Tags(langTag).format();\r\n};\r\n\r\nexport const languageInput2tag = (languageInput: LanguageInput): string => {\r\n  return subTags2Tag({\r\n    lang: languageInput.language_code,\r\n    dialect: languageInput.dialect_code || undefined,\r\n    region: languageInput.geo_code || undefined,\r\n  });\r\n};\r\n"],"names":["GroupedFilterSymbols","DESCRIPTIONS_JOINER","NOT_DEFINED_PLACEHOLDER","TagTypes","sortTagInfosFn","t1","t2","descriptions","X_LANG_TAGS","tag","TagSpecialDescriptions","xTag2langInfo","tagGiven","foundXtagIndex","findIndex","xTag","lang","tag2langInfo","complexTag","Tags","find","LANGUAGE","region","REGION","dialect","DIALECT","langInfo","format","getLangsRegistry","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","enabledTags","wrap","_context","prev","next","abrupt","Promise","resolve","_step","allTags","search","langs","concat","dialects","regions","_iterator","_createForOfIteratorHelperLoose","done","currTag","value","includes","deprecated","PRIVATE_USE","type","push","sort","stop","_x","apply","this","arguments","subTags2Tag","_ref3","xt","langTag","a","b","_a$dialect","_b$dialect","_a$region","_b$region","_langInfo$lang$descri","_langInfo$region2","_langInfo$dialect2","_xTag$descriptions","join","_langInfo$region3","_langInfo$dialect3","res","_langInfo$dialect","_langInfo$region","language_code","dialect_code","geo_code","languageInput","undefined","d1","d2","siteTextlikeString","toLowerCase","_ref"],"mappings":"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"}