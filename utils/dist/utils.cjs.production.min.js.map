{"version":3,"file":"utils.cjs.production.min.js","sources":["../src/constants.ts","../src/sortingFns/sortingFns.ts","../src/langUtils/langUtils.ts"],"sourcesContent":["import { TDialect, TLang, TRegion } from './types';\n\nexport const DESCRIPTIONS_JOINER = '/';\nexport const NOT_DEFINED_PLACEHOLDER = '- not defined -';\nexport const LOADING_TAG_PLACEHOLDER = {\n  tag: 'loading',\n  descriptions: ['Loading data...'],\n} as TDialect & TRegion & TLang;\n\nexport enum GroupedFilterSymbols {\n  Digits = '0-9',\n  SpecialCharacters = '#',\n}\n","import { NOT_DEFINED_PLACEHOLDER } from '../constants';\nimport { IDefinition, ITagInfo } from '../types';\n\nexport const sortSiteTextFn = (d1: IDefinition, d2: IDefinition) => {\n  if (\n    d1.siteTextlikeString &&\n    d2.siteTextlikeString &&\n    d1.siteTextlikeString.toLowerCase() > d2.siteTextlikeString.toLowerCase()\n  ) {\n    return 1;\n  }\n\n  if (\n    d1.siteTextlikeString &&\n    d2.siteTextlikeString &&\n    d1.siteTextlikeString.toLowerCase() < d2.siteTextlikeString.toLowerCase()\n  ) {\n    return -1;\n  }\n  return 0;\n};\n\nexport const sortTagInfosFn = (t1: ITagInfo, t2: ITagInfo) => {\n  if (t1.descriptions && t1.descriptions[0] === NOT_DEFINED_PLACEHOLDER) {\n    return -1;\n  }\n  if (t2.descriptions && t2.descriptions[0] === NOT_DEFINED_PLACEHOLDER) {\n    return 1;\n  }\n  if (\n    t1.descriptions &&\n    t2.descriptions &&\n    t1.descriptions[0] > t2.descriptions[0]\n  ) {\n    return 1;\n  }\n  if (\n    t1.descriptions &&\n    t2.descriptions &&\n    t1.descriptions[0] < t2.descriptions[0]\n  ) {\n    return -1;\n  }\n  return 0;\n};\n","import { DESCRIPTIONS_JOINER, NOT_DEFINED_PLACEHOLDER } from '../constants';\nimport { sortTagInfosFn } from '../sortingFns/sortingFns';\nimport {\n  LanguageInfo,\n  LanguageInput,\n  TDialect,\n  TLang,\n  TRegion,\n} from '../types';\n\nimport Tags from 'language-tags';\n\n// X_LANG_TAGS is an array of private (x-...) subtags; they are used as additional language tags to represent languages\n// that are not present in the `language-tags` npm package (which refers to the IANA registry).\n// List of main language tags we get from the `language-tags` library will be extended with these x- tags.\nexport const X_LANG_TAGS: Array<TLang> = [\n  { tag: 'x-senga', descriptions: ['Senga'] },\n  { tag: 'x-fungwe', descriptions: ['Fungwe'] },\n  { tag: 'x-tambo', descriptions: ['Tambo'] },\n  { tag: 'x-wandya', descriptions: ['Wandya'] },\n  { tag: 'x-lungu', descriptions: ['Lungu'] },\n  { tag: 'x-chikunda', descriptions: ['Chikunda'] },\n  { tag: 'x-kabdende', descriptions: ['Kabdende'] },\n  { tag: 'x-shila', descriptions: ['Shila'] },\n  { tag: 'x-mwenyi', descriptions: ['Mwenyi'] },\n  { tag: 'x-liuwa', descriptions: ['Liuwa'] },\n  { tag: 'x-Seabo', descriptions: ['Seabo'] },\n];\n\nenum TagTypes {\n  LANGUAGE = 'language',\n  REGION = 'region',\n  DIALECT = 'variant',\n}\n\nexport const xTag2langInfo = (tagGiven: string): LanguageInfo | undefined => {\n  const foundXtagIndex = X_LANG_TAGS.findIndex((xTag) => xTag.tag === tagGiven);\n  if (foundXtagIndex >= 0) {\n    return {\n      lang: X_LANG_TAGS[foundXtagIndex],\n    };\n  } else return undefined;\n};\n\nexport const tag2langInfo = (tagGiven: string): LanguageInfo => {\n  if (xTag2langInfo(tagGiven)) return xTag2langInfo(tagGiven)!;\n  const complexTag = Tags(tagGiven);\n  const lang = complexTag.find(TagTypes.LANGUAGE);\n  const region = complexTag.find(TagTypes.REGION);\n  const dialect = complexTag.find(TagTypes.DIALECT);\n  const langInfo: LanguageInfo = {\n    lang: { tag: lang?.format() || '', descriptions: lang?.descriptions() },\n  };\n  if (region) {\n    langInfo.region = {\n      tag: region.format(),\n      descriptions: region.descriptions(),\n    };\n  }\n  if (dialect) {\n    langInfo.dialect = {\n      tag: dialect.format(),\n      descriptions: dialect.descriptions(),\n    };\n  }\n  return langInfo;\n};\n\nexport const langInfo2tag = (\n  langInfo: LanguageInfo | undefined\n): string | undefined => {\n  if (!langInfo) return undefined;\n  const { lang, region, dialect } = langInfo;\n  let langTag = lang.tag;\n\n  const xTag = X_LANG_TAGS.find((xt) => xt.tag === langTag);\n  if (xTag) return xTag.tag;\n\n  region?.tag && (langTag += '-' + region?.tag);\n  dialect?.tag && (langTag += '-' + dialect?.tag);\n  return Tags(langTag).format();\n};\n\nexport const langInfo2langInput = (langInfo: LanguageInfo): LanguageInput => {\n  return {\n    language_code: langInfo.lang.tag,\n    dialect_code: langInfo.dialect?.tag || null,\n    geo_code: langInfo.region?.tag || null,\n  };\n};\n\nexport const langInfo2String = (langInfo: LanguageInfo | undefined): string => {\n  const xTag = X_LANG_TAGS.find((xt) => xt.tag === langInfo?.lang.tag);\n  if (xTag) {\n    return xTag.descriptions?.join(DESCRIPTIONS_JOINER) || xTag.tag;\n  }\n  let res = langInfo?.lang.descriptions?.join(DESCRIPTIONS_JOINER);\n  if (!res) return '';\n  if (langInfo?.region?.descriptions) {\n    res += ' ' + langInfo.region?.descriptions.join(DESCRIPTIONS_JOINER);\n  }\n  if (langInfo?.dialect?.descriptions) {\n    res +=\n      ', dialect:' + langInfo?.dialect?.descriptions.join(DESCRIPTIONS_JOINER);\n  }\n  return res;\n};\n\nexport const subTags2LangInfo = ({\n  lang,\n  region,\n  dialect,\n}: {\n  lang: string;\n  region?: string;\n  dialect?: string;\n}): LanguageInfo => {\n  if (xTag2langInfo(lang)) return xTag2langInfo(lang)!;\n  let langTag = lang;\n  region && (langTag += '-' + region);\n  dialect && (langTag += '-' + dialect);\n  langTag = Tags(langTag).format();\n  return tag2langInfo(langTag);\n};\n\nexport const compareLangInfo = (\n  a: LanguageInfo | null | undefined,\n  b: LanguageInfo | null | undefined\n): boolean => {\n  if (a === b) return true; // case both null or both undefined\n  if (!a || !b) return false; // case one of them null or undefined\n  if (a.lang.tag !== b.lang.tag) {\n    return false;\n  }\n\n  if (a.dialect?.tag !== b.dialect?.tag) {\n    return false;\n  }\n\n  if (a.region?.tag !== b.region?.tag) {\n    return false;\n  }\n\n  return true;\n};\n\ntype LangsRegistry = {\n  langs: Array<TLang>;\n  dialects: Array<TDialect>;\n  regions: Array<TRegion>;\n};\n\nenum TagSpecialDescriptions {\n  PRIVATE_USE = 'Private use',\n}\n\n// make it async to test and prepare for possible language library change to async\nexport const getLangsRegistry = async (\n  enabledTags?: string[]\n): Promise<LangsRegistry> => {\n  return new Promise((resolve) => {\n    const allTags = Tags.search(/.*/);\n    const langs: Array<TLang> = enabledTags\n      ? [...X_LANG_TAGS].filter((xt) => enabledTags.includes(xt.tag))\n      : [...X_LANG_TAGS];\n    const dialects: Array<TDialect> = [\n      { tag: null, descriptions: [NOT_DEFINED_PLACEHOLDER] },\n    ];\n    const regions: Array<TRegion> = [\n      { tag: null, descriptions: [NOT_DEFINED_PLACEHOLDER] },\n    ];\n\n    for (const currTag of allTags) {\n      if (enabledTags && !enabledTags.includes(currTag.format())) {\n        continue;\n      }\n\n      if (\n        currTag.deprecated() ||\n        currTag.descriptions().includes(TagSpecialDescriptions.PRIVATE_USE)\n      ) {\n        continue;\n      }\n\n      if (currTag.type() === TagTypes.LANGUAGE) {\n        langs.push({\n          tag: currTag.format(),\n          descriptions: currTag.descriptions(),\n        });\n      }\n      if (currTag.type() === TagTypes.REGION) {\n        regions.push({\n          tag: currTag.format(),\n          descriptions: currTag.descriptions(),\n        });\n      }\n      if (currTag.type() === TagTypes.DIALECT) {\n        dialects.push({\n          tag: currTag.format(),\n          descriptions: currTag.descriptions(),\n        });\n      }\n    }\n    langs.sort(sortTagInfosFn);\n    dialects.sort(sortTagInfosFn);\n    regions.sort(sortTagInfosFn);\n\n    resolve({\n      langs,\n      dialects,\n      regions,\n    });\n  });\n};\n\nexport const subTags2Tag = ({\n  lang,\n  region,\n  dialect,\n}: {\n  lang: string;\n  region?: string;\n  dialect?: string;\n}): string => {\n  if (X_LANG_TAGS.find((xt) => xt.tag === lang)) return lang;\n  let langTag = lang;\n  region && (langTag += '-' + region);\n  dialect && (langTag += '-' + dialect);\n  return Tags(langTag).format();\n};\n\nexport const languageInput2tag = (languageInput: LanguageInput): string => {\n  return subTags2Tag({\n    lang: languageInput.language_code,\n    dialect: languageInput.dialect_code || undefined,\n    region: languageInput.geo_code || undefined,\n  });\n};\n"],"names":["GroupedFilterSymbols","DESCRIPTIONS_JOINER","NOT_DEFINED_PLACEHOLDER","TagTypes","sortTagInfosFn","t1","t2","descriptions","X_LANG_TAGS","tag","TagSpecialDescriptions","xTag2langInfo","tagGiven","foundXtagIndex","findIndex","xTag","lang","tag2langInfo","complexTag","Tags","find","LANGUAGE","region","REGION","dialect","DIALECT","langInfo","format","getLangsRegistry","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","enabledTags","wrap","_context","prev","next","abrupt","Promise","resolve","_step","allTags","search","langs","concat","filter","xt","includes","dialects","regions","_iterator","_createForOfIteratorHelperLoose","done","currTag","value","deprecated","PRIVATE_USE","type","push","sort","stop","_x","apply","this","arguments","subTags2Tag","_ref3","langTag","a","b","_a$dialect","_b$dialect","_a$region","_b$region","_langInfo$lang$descri","_langInfo$region2","_langInfo$dialect2","_xTag$descriptions","join","_langInfo$region3","_langInfo$dialect3","res","_langInfo$dialect","_langInfo$region","language_code","dialect_code","geo_code","languageInput","undefined","d1","d2","siteTextlikeString","toLowerCase","_ref"],"mappings":"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"}